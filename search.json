[{"path":"https://joe-m-shaw.github.io/foldchanger/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 foldchanger authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/articles/detection_thresholds.html","id":"amplifications","dir":"Articles","previous_headings":"","what":"Amplifications","title":"Detection thresholds","text":"cancer, oncogenes can amplified copy numbers rangeing tens hundreds copies standard 2 copies per cell. Using pred_cpc function, can predict gene copies per tumour cell detected different neoplastic cell contents fold change threshold 2.8 applied. can use ggplot show results.","code":"df_amp <- data.frame(ncc = seq(0, 100, by = 0.1)) |>    mutate(gene_copies = pred_cpc(fc = 2.8,                                  ncc = ncc,                                  dir = \"gain\",                                 digits = 3))"},{"path":"https://joe-m-shaw.github.io/foldchanger/articles/detection_thresholds.html","id":"deletions","dir":"Articles","previous_headings":"","what":"Deletions","title":"Detection thresholds","text":"gene deletions, number gene copies per tumour cell limited. Assuming cell diploid, cell can normal gene copy number 2, copy number 1 gene heterozygously deleted, copy number 0 gene homozygously deleted. using pred_fc function, can predict fold changes deletion state different neoplastic cell contents. plotting results, can see determination neoplastic cell content critical differentiating homozygous heterozygous deletions fold change greater -2.","code":"df_del <- data.frame(ncc = seq(0, 100, by = 0.1)) |>    mutate(fold_change_normal = pred_fc(tumour_cpc = 2,                                       ncc = ncc,                                       dir = \"loss\",                                       digits = 3),          fold_change_het_del = pred_fc(tumour_cpc = 1,                                        ncc = ncc,                                        dir = \"loss\",                                        digits = 3),          fold_change_hom_del = pred_fc(tumour_cpc = 0,                                        ncc = ncc,                                        dir = \"loss\",                                        digits = 3)) |>    pivot_longer(cols = -ncc,                names_to = \"del_state\",                values_to = \"fold_change\")"},{"path":"https://joe-m-shaw.github.io/foldchanger/articles/dosage_calculations.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Dosage calculations","text":"Detection dosage changes genes within cancer cells can important implications prognosis treatment. Cancer samples comprise mixture cells cancer normal patient tissue (stroma). Consequently, DNA extracted cancer samples mixture DNA cancer cells stromal cells. Using Illumina next generation sequencing (NGS), gene dosage can calculated using “depth--coverage” methods: number sequencing reads mapping particular locus used infer dosage locus within sample. observed number reads can compared expected number reads gene locus. expected value derived cohort normal tissue samples tested NGS process.","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/articles/dosage_calculations.html","id":"equations","dir":"Articles","previous_headings":"","what":"Equations","title":"Dosage calculations","text":"different ways presenting relationship observed expected read depth. Firstly, can take log2 ratio observed vs expected read depth. log2ratio=log2(observed/expected) log2ratio = log2(observed / expected) Alternatively, “fold change” can calculated. Two separate fold change calculations used Qiagen calculating gains losses genetic information (described CLC handbook, section Copy number fold change). Fold change gains calculated : fcgain=observed/expected fcgain = observed / expected Fold change losses calculated : fcloss=−(expected/observed) fcloss = - (expected / observed)","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/articles/dosage_calculations.html","id":"rationale","dir":"Articles","previous_headings":"","what":"Rationale","title":"Dosage calculations","text":"two different equations fold change may seem confusing, reason allow greater precision dosage measurement. can explore foldchanger creating dataset observed expected values fictional experiment calculating dosage different formats using calc_fc calc_log2r functions. fold change loss equation provides differentiation coverage levels fewer reads observed expected.  Conversely, fold change gain equation useful gene amplifications present: number observed reads may several fold higher expected.","code":"df <- data.frame(   \"obs\" = seq(0, 5000, by = 1),   \"exp\" = 100) |>   mutate(     log2r = calc_log2r(obs, exp),     fc_gain = calc_fc(obs, exp, \"gain\"),     fc_loss = calc_fc(obs, exp, \"loss\")) |>   pivot_longer(cols = c(log2r, fc_gain, fc_loss),                names_to = \"metric\",                values_to = \"value\") |>   mutate(ratio = obs/exp,          metric = factor(metric, levels = c(\"fc_gain\",                                              \"log2r\",                                              \"fc_loss\")))"},{"path":"https://joe-m-shaw.github.io/foldchanger/articles/dosage_calculations.html","id":"simulated-data","dir":"Articles","previous_headings":"","what":"Simulated data","title":"Dosage calculations","text":"can see different equations present artificial dataset. fake chromosome region normal dosage, amplified region, region dosage loss. log2 ratio looks like .  fold change gain equation looks like . Notice amplified region “pulled ” separated normal dosage region, normal dosage region now average value 1, 0.  fold change loss equation looks like . reverse gain equation, loss equation pulls deleted region normal dosage baseline, normal dosage region now average value -1.  can also combine fold change equations, gain equation used observed dosage higher expected, loss equation used observed dosage lower expected. results “splitting” central cluster normal dosage points.  ease comparison, four ways plotting data next .","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Joe M. Shaw. Author, maintainer.","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Shaw J (2025). foldchanger: Change Easily Dosage Formats. R package version 1.0.0, https://joe-m-shaw.github.io/foldchanger/.","code":"@Manual{,   title = {foldchanger: Change Easily Between Dosage Formats},   author = {Joe M. Shaw},   year = {2025},   note = {R package version 1.0.0},   url = {https://joe-m-shaw.github.io/foldchanger/}, }"},{"path":"https://joe-m-shaw.github.io/foldchanger/index.html","id":"foldchanger-","dir":"","previous_headings":"","what":"Change Easily Between Dosage Formats","title":"Change Easily Between Dosage Formats","text":"foldchanger package performing fold change calculations. calculations used detection genetic copy number variants next generation sequencing. building foldchanger mini-project teach R package development.","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Change Easily Between Dosage Formats","text":"can install development version foldchanger GitHub :","code":"# install.packages(\"pak\") pak::pak(\"joe-m-shaw/foldchanger\")"},{"path":"https://joe-m-shaw.github.io/foldchanger/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Change Easily Between Dosage Formats","text":"foldchanger provides bunch helpful functions make interacting fold changes log2ratios easier. example, pred_cpc can used predict copies per cell (CPC) genes within tumour sample, based neoplastic cell content (NCC) fold change. Let’s imagine measure fold change 11 EGFR gene tumour sample NCC 65%: want predict fold change see sample 109 copies EGFR per tumour cell NCC 26%: want change two forms fold change log2ratio:","code":"library(foldchanger) pred_cpc(fc = 11, ncc = 65, dir = \"gain\") #> [1] 33 pred_fc(tumour_cpc = 109, ncc = 26, dir = \"gain\") #> [1] 14.9 change(1, from = \"fcgain\", to = \"log2r\") #> [1] 0  change(-1, from = \"log2r\", to = \"fcloss\") #> [1] -2"},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/calc_fc.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate fold change from observed and expected depth-of-coverage — calc_fc","title":"Calculate fold change from observed and expected depth-of-coverage — calc_fc","text":"Calculate fold change observed expected depth--coverage","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/calc_fc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate fold change from observed and expected depth-of-coverage — calc_fc","text":"","code":"calc_fc(obs, exp, dir)"},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/calc_fc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate fold change from observed and expected depth-of-coverage — calc_fc","text":"obs Observed depth--coverage exp Expected depth--coverage dir direction fold change calculate - \"gain\" \"loss\"","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/calc_fc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate fold change from observed and expected depth-of-coverage — calc_fc","text":"calculated fold change","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/calc_fc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate fold change from observed and expected depth-of-coverage — calc_fc","text":"","code":"calc_fc(10, 2, dir = \"gain\") #> [1] 5"},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/calc_log2r.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate log2 ratios — calc_log2r","title":"Calculate log2 ratios — calc_log2r","text":"Calculate log2 ratios","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/calc_log2r.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate log2 ratios — calc_log2r","text":"","code":"calc_log2r(obs, exp, digits = 3)"},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/calc_log2r.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate log2 ratios — calc_log2r","text":"obs Observed reads exp Expected reads digits Number decimal places","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/calc_log2r.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate log2 ratios — calc_log2r","text":"Log2 ratio","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/calc_log2r.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate log2 ratios — calc_log2r","text":"","code":"calc_log2r(10, 5) #> [1] 1"},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/calc_tc.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate total copies from copies per cell — calc_tc","title":"Calculate total copies from copies per cell — calc_tc","text":"Calculate total copies copies per cell","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/calc_tc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate total copies from copies per cell — calc_tc","text":"","code":"calc_tc(cpc, cells = 100)"},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/calc_tc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate total copies from copies per cell — calc_tc","text":"cpc Copies per cell cells Total number cells. Defaults 100.","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/calc_tc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate total copies from copies per cell — calc_tc","text":"Total copies gene locus","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/calc_tc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate total copies from copies per cell — calc_tc","text":"","code":"calc_tc(10, 100) #> [1] 1000"},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/change.html","id":null,"dir":"Reference","previous_headings":"","what":"Change between fold change and log2 ratios — change","title":"Change between fold change and log2 ratios — change","text":"Change fold change log2 ratios","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/change.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Change between fold change and log2 ratios — change","text":"","code":"change(input, from, to)"},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/change.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Change between fold change and log2 ratios — change","text":"input Input value format change format change ","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/change.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Change between fold change and log2 ratios — change","text":"calculated output","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/change.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Change between fold change and log2 ratios — change","text":"","code":"change(-1, from = \"log2r\", to = \"fcloss\") #> [1] -2"},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/check_dir.html","id":null,"dir":"Reference","previous_headings":"","what":"Check fold change direction argument is appropriate — check_dir","title":"Check fold change direction argument is appropriate — check_dir","text":"Check fold change direction argument appropriate","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/check_dir.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check fold change direction argument is appropriate — check_dir","text":"","code":"check_dir(x)"},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/check_dir.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check fold change direction argument is appropriate — check_dir","text":"x Fold change direction","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/check_dir.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check fold change direction argument is appropriate — check_dir","text":"Errors fold change supplied \"gain\" \"loss\"","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/check_dir.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check fold change direction argument is appropriate — check_dir","text":"","code":"check_dir(\"loss\")"},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/check_ncc.html","id":null,"dir":"Reference","previous_headings":"","what":"Check neoplastic cell content is in correct format — check_ncc","title":"Check neoplastic cell content is in correct format — check_ncc","text":"Check neoplastic cell content correct format","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/check_ncc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check neoplastic cell content is in correct format — check_ncc","text":"","code":"check_ncc(ncc)"},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/check_ncc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check neoplastic cell content is in correct format — check_ncc","text":"ncc Neplastic cell content percentage format (10% 0.1)","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/check_ncc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check neoplastic cell content is in correct format — check_ncc","text":"Errors incorrect format supplied","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/check_ncc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check neoplastic cell content is in correct format — check_ncc","text":"","code":"check_ncc(100)"},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/pred_cpc.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict copies per cell — pred_cpc","title":"Predict copies per cell — pred_cpc","text":"Predict copies per cell","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/pred_cpc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict copies per cell — pred_cpc","text":"","code":"pred_cpc(fc, ncc, dir, ref_cpc = 2, stroma_cpc = 2, digits = 0)"},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/pred_cpc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict copies per cell — pred_cpc","text":"fc Fold change ncc Neoplastic cell content (0-100) dir Fold change direction, must \"gain\" \"loss\" ref_cpc Copies per cell reference cohort stroma_cpc Copies per cell patient stroma digits number decimal places round ","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/pred_cpc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict copies per cell — pred_cpc","text":"Copies per cell","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/pred_cpc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predict copies per cell — pred_cpc","text":"","code":"pred_cpc(fc = 11, ncc = 65, dir = \"gain\") #> [1] 33"},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/pred_fc.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict fold change from copies per cell — pred_fc","title":"Predict fold change from copies per cell — pred_fc","text":"Predict fold change copies per cell","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/pred_fc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict fold change from copies per cell — pred_fc","text":"","code":"pred_fc(tumour_cpc, ncc, dir, ref_cpc = 2, stroma_cpc = 2, digits = 1)"},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/pred_fc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict fold change from copies per cell — pred_fc","text":"tumour_cpc Copies gene locus per tumour cell ncc Neoplastic cell content dir Fold change direction, must \"gain\" \"loss\" ref_cpc Copies gene locus per reference cohort cell stroma_cpc Copies gene locus per stroma cell digits Digits round fold change ","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/pred_fc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict fold change from copies per cell — pred_fc","text":"predicted fold change","code":""},{"path":"https://joe-m-shaw.github.io/foldchanger/reference/pred_fc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predict fold change from copies per cell — pred_fc","text":"","code":"pred_fc(tumour_cpc = 109, ncc = 26, dir = \"gain\") #> [1] 14.9"}]
